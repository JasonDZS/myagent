# MyAgent WebSocket æ–‡æ¡£ä¸­å¿ƒ

## ğŸ“š æ–‡æ¡£å¯¼èˆª

### ğŸš€ å¿«é€Ÿå¼€å§‹
- [**åŸºç¡€æ¦‚å¿µ**](./basic-concepts.md) - WebSocketåè®®ã€äº‹ä»¶ç³»ç»Ÿå’Œæ ¸å¿ƒæ¦‚å¿µ
- [**é€šç”¨åè®®æ–¹æ¡ˆ**](./universal-client-protocol.md) - å®Œæ•´çš„é€šç”¨å®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡åè®®
- [**å¿«é€Ÿå¼€å§‹**](./quick-start.md) - 5åˆ†é’Ÿä¸Šæ‰‹ï¼Œæ”¯æŒHTMLã€Node.jsã€Python
- [**æ—¶åºå›¾**](./sequence-diagram.md) - å®Œæ•´çš„æ¶ˆæ¯äº¤äº’æµç¨‹å›¾

### ğŸ”§ æ ¸å¿ƒåŠŸèƒ½
- [**ç”¨æˆ·ç¡®è®¤æœºåˆ¶**](./user-confirmation.md) - å±é™©æ“ä½œçš„ç¡®è®¤æµç¨‹å®ç°
- [**å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†**](./client-state-management.md) - ä¼šè¯çŠ¶æ€çš„å®¢æˆ·ç«¯å­˜å‚¨å’Œæ¢å¤
- [**æ•°æ®å¯è§†åŒ–é›†æˆ**](./visualization-integration.md) - EChartså›¾è¡¨å¯è§†åŒ–æ”¯æŒ

### ğŸ¯ æ¡†æ¶é›†æˆ
- [**React é›†æˆ**](./react-integration.md) - å®Œæ•´çš„React Hookå’Œç»„ä»¶å®ç°

## ğŸ¯ é€‰æ‹©ä½ çš„æ–¹æ¡ˆ

### æˆ‘æ˜¯å‰ç«¯æ–°æ‰‹
ğŸ‘‰ ä» [**å¿«é€Ÿå¼€å§‹**](./quick-start.md) å¼€å§‹ï¼Œä½¿ç”¨ HTML+JavaScript ç‰ˆæœ¬

### æˆ‘ä½¿ç”¨ React
ğŸ‘‰ ç›´æ¥æŸ¥çœ‹ [**React é›†æˆ**](./react-integration.md)ï¼Œè·å–å®Œæ•´çš„Hookå’Œç»„ä»¶

### æˆ‘ä½¿ç”¨ Vue
ğŸ‘‰ æŸ¥çœ‹ [**æ•°æ®å¯è§†åŒ–é›†æˆ**](./visualization-integration.md)ï¼Œå›¾è¡¨å±•ç¤ºåŠŸèƒ½

### æˆ‘éœ€è¦äº†è§£åè®®ç»†èŠ‚
ğŸ‘‰ é˜…è¯» [**åŸºç¡€æ¦‚å¿µ**](./basic-concepts.md) å’Œ [**é€šç”¨åè®®æ–¹æ¡ˆ**](./universal-client-protocol.md)

### æˆ‘éœ€è¦é€šç”¨çš„WebSocketè§£å†³æ–¹æ¡ˆ
ğŸ‘‰ æŸ¥çœ‹ [**é€šç”¨åè®®æ–¹æ¡ˆ**](./universal-client-protocol.md)ï¼Œè·å–å®Œæ•´çš„å®¢æˆ·ç«¯-æœåŠ¡å™¨é€šä¿¡åè®®

### æˆ‘çš„åº”ç”¨éœ€è¦ç”¨æˆ·ç¡®è®¤
ğŸ‘‰ é‡ç‚¹å…³æ³¨ [**ç”¨æˆ·ç¡®è®¤æœºåˆ¶**](./user-confirmation.md)

### æˆ‘éœ€è¦ä¼šè¯çŠ¶æ€æŒä¹…åŒ–
ğŸ‘‰ æŸ¥çœ‹ [**å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†**](./client-state-management.md)ï¼Œå®ç°ç¦»çº¿çŠ¶æ€æ¢å¤

## âš¡ æ ¸å¿ƒç‰¹æ€§ä¸€è§ˆ

### ğŸ”„ å®æ—¶åŒå‘é€šä¿¡
- WebSocketé•¿è¿æ¥ï¼Œä½å»¶è¿Ÿäº¤äº’
- è‡ªåŠ¨é‡è¿æœºåˆ¶ï¼Œå¤„ç†ç½‘ç»œå¼‚å¸¸
- å¿ƒè·³æ£€æµ‹ï¼Œç»´æŒè¿æ¥å¥åº·

### ğŸ§  Agentäº¤äº’æ”¯æŒ
- æ€è€ƒçŠ¶æ€å®æ—¶æ˜¾ç¤º
- æµå¼å›ç­”ï¼Œé€æ­¥å±•ç¤ºç»“æœ
- å·¥å…·è°ƒç”¨è¿‡ç¨‹å¯è§†åŒ–

### âš ï¸ ç”¨æˆ·ç¡®è®¤æœºåˆ¶
- å±é™©æ“ä½œå‰å¼ºåˆ¶ç¡®è®¤
- å‚æ•°è¯¦æƒ…å±•ç¤º
- è‡ªå®šä¹‰ç¡®è®¤æ¶ˆæ¯

### ğŸ’¾ å®¢æˆ·ç«¯çŠ¶æ€ç®¡ç†
- ä¼šè¯çŠ¶æ€å®¢æˆ·ç«¯å­˜å‚¨
- ç¦»çº¿åçŠ¶æ€æ¢å¤
- å®‰å…¨çŠ¶æ€ç­¾åéªŒè¯
- è·¨è®¾å¤‡çŠ¶æ€è¿ç§»

### ğŸ“± å¤šç«¯é€‚é…
- å“åº”å¼è®¾è®¡ï¼Œæ”¯æŒç§»åŠ¨ç«¯
- å®Œæ•´çš„é”®ç›˜å¿«æ·é”®æ”¯æŒ
- å¯è®¿é—®æ€§ä¼˜åŒ–

## ğŸ“‹ äº‹ä»¶ç±»å‹é€ŸæŸ¥

### ç”¨æˆ·äº‹ä»¶ (å‘é€)
```javascript
user.create_session        // åˆ›å»ºä¼šè¯
user.message              // å‘é€æ¶ˆæ¯  
user.response             // ç¡®è®¤å“åº”
user.cancel               // å–æ¶ˆæ‰§è¡Œ
user.request_state        // è¯·æ±‚å¯¼å‡ºçŠ¶æ€
user.reconnect_with_state // ä½¿ç”¨çŠ¶æ€é‡è¿
```

### Agentäº‹ä»¶ (æ¥æ”¶)
```javascript
agent.session_created  // ä¼šè¯åˆ›å»ºæˆåŠŸ
agent.thinking         // æ€è€ƒçŠ¶æ€
agent.tool_call        // å·¥å…·è°ƒç”¨
agent.tool_result      // å·¥å…·ç»“æœ
agent.user_confirm     // è¯·æ±‚ç¡®è®¤
agent.partial_answer   // æµå¼å›ç­”
agent.final_answer     // æœ€ç»ˆå›ç­”
agent.state_exported   // çŠ¶æ€å¯¼å‡ºå®Œæˆ
agent.state_restored   // çŠ¶æ€æ¢å¤å®Œæˆ
agent.error           // æ‰§è¡Œé”™è¯¯
```

### ç³»ç»Ÿäº‹ä»¶ (æ¥æ”¶)
```javascript
system.connected    // è¿æ¥ç¡®è®¤
system.heartbeat    // å¿ƒè·³æ£€æµ‹
system.error        // ç³»ç»Ÿé”™è¯¯
```

## ğŸ”§ åŸºç¡€æ¶ˆæ¯æ ¼å¼

```typescript
interface WebSocketMessage {
  event: string;           // äº‹ä»¶ç±»å‹
  timestamp: string;       // ISOæ—¶é—´æˆ³
  session_id?: string;     // ä¼šè¯ID (éç³»ç»Ÿäº‹ä»¶å¿…éœ€)
  step_id?: string;        // æ­¥éª¤ID (ç”¨äºè¯·æ±‚å“åº”å…³è”)
  content?: string | object; // æ¶ˆæ¯å†…å®¹
  metadata?: object;       // å…ƒæ•°æ®
}
```

## ğŸš€ å¿«é€Ÿç¤ºä¾‹

### åŸºç¡€è¿æ¥
```javascript
const ws = new WebSocket('ws://localhost:8080');

ws.onopen = () => {
    // åˆ›å»ºä¼šè¯
    ws.send(JSON.stringify({
        event: 'user.create_session',
        timestamp: new Date().toISOString(),
        content: 'create_session'
    }));
};

ws.onmessage = (event) => {
    const data = JSON.parse(event.data);
    console.log('æ”¶åˆ°æ¶ˆæ¯:', data);
    
    if (data.event === 'agent.session_created') {
        // å‘é€æµ‹è¯•æ¶ˆæ¯
        ws.send(JSON.stringify({
            session_id: data.session_id,
            event: 'user.message',
            timestamp: new Date().toISOString(),
            content: 'ä½ å¥½ï¼'
        }));
    }
};
```

### React Hook ä½¿ç”¨
```typescript
function ChatApp() {
    const { 
        connected, 
        messages, 
        sendMessage, 
        pendingConfirmation,
        respondToConfirmation 
    } = useMyAgent();

    return (
        <div>
            {messages.map(msg => (
                <div key={msg.id}>{msg.content}</div>
            ))}
            
            {pendingConfirmation && (
                <ConfirmationDialog 
                    confirmation={pendingConfirmation}
                    onConfirm={respondToConfirmation}
                />
            )}
            
            <input onKeyPress={(e) => {
                if (e.key === 'Enter') {
                    sendMessage(e.target.value);
                    e.target.value = '';
                }
            }} />
        </div>
    );
}
```

## ğŸ›Ÿ è·å–å¸®åŠ©

### å¸¸è§é—®é¢˜
æŸ¥çœ‹ [**åŸºç¡€æ¦‚å¿µæ–‡æ¡£**](./basic-concepts.md)ï¼Œäº†è§£æ›´å¤šæŠ€æœ¯ç»†èŠ‚ã€‚

### é—®é¢˜æŠ¥å‘Š
å¦‚æœä½ å‘ç°äº†æ–‡æ¡£ä¸­çš„é”™è¯¯æˆ–éœ€è¦æ–°åŠŸèƒ½ï¼Œè¯·åœ¨ GitHub Issues ä¸­åé¦ˆã€‚

### ç¤¾åŒºæ”¯æŒ
åŠ å…¥æˆ‘ä»¬çš„å¼€å‘è€…ç¤¾åŒºï¼Œä¸å…¶ä»–å¼€å‘è€…äº¤æµç»éªŒã€‚

---

**å¿«é€Ÿå¼€å§‹** ğŸ‘‰ é€‰æ‹©ä½ æ„Ÿå…´è¶£çš„æ–‡æ¡£å¼€å§‹å§ï¼